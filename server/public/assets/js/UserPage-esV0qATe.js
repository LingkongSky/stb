import{u as a,b as e,r as l,o as u,e as s,f as r,h as n,m as v,i,k as t,au as o,g as d,A as c,j as p,p as m,v as f,az as g,$ as y,F as _,x as b,av as k,a1 as h,aw as I,I as $,a4 as j}from"./vendor-DLaggKmm.js";import{_ as w,u as z,i as x}from"./index-CJP2_w2Y.js";import{a as C}from"./formatDate-DJT1dS-E.js";const A={class:"user-page"},U={key:0,class:"user-profile"},D={class:"user-details"},F={key:1,class:"album-grid"},P={key:1,class:"none-cover"},q={key:0,class:"pagination"},B=w({__name:"UserPage",setup(w){const B=a(),E=e(),G=z(),H=l(null),J=l(null),K=l([]),L=l(!1),M=l(!1),N=l(1),O=l(10),Q=l(0),R=async a=>{var e;M.value=!0,K.value=[],Q.value=0;try{const{data:e}=await x.post(`/api/public/users/${a}/albums`,j.stringify({page:N.value,limit:O.value}));K.value=e.albums||[],Q.value=e.total||0}catch({response:l}){$.error((null==(e=null==l?void 0:l.data)?void 0:e.error)||"获取公开相册列表失败")}finally{M.value=!1}},S=a=>{N.value=a,R(H.value)};return u((()=>{H.value=B.params.userId,(async a=>{var e;L.value=!0,J.value=null;try{const{data:e}=await x.post(`/api/public/users/${a}`,{});J.value=e}catch({response:l}){$.error((null==(e=null==l?void 0:l.data)?void 0:e.error)||"获取用户信息失败")}finally{L.value=!1}})(H.value),N.value=1,R(H.value)})),(a,e)=>{const l=c,u=g,$=o,j=y,w=h,z=k,x=I;return r(),s("div",A,[n(j,{class:"user-info-card"},{default:t((()=>[n($,{spinning:L.value},{default:t((()=>{var a,e,i;return[J.value?(r(),s("div",U,[n(l,{src:(null==(i=null==(e=null==(a=p(G))?void 0:a.config)?void 0:e.site)?void 0:i.url)+J.value.avatar,size:80},{default:t((()=>[m(f(J.value.username),1)])),_:1},8,["src"]),d("div",D,[d("h2",null,f(J.value.username),1),d("p",null,"注册时间: "+f(p(C)(J.value.createdAt)),1)])])):(r(),v(u,{key:1,description:"用户不存在"}))]})),_:1},8,["spinning"])])),_:1}),J.value?(r(),v(j,{key:0,class:"public-albums-card"},{default:t((()=>{var a,l,o,c;return[d("h3",null,f((null==(a=J.value)?void 0:a.username)===(null==(o=null==(l=p(G))?void 0:l.user)?void 0:o.username)?"我":null==(c=J.value)?void 0:c.username)+"的公开相册",1),n($,{spinning:M.value},{default:t((()=>[0!==K.value.length||M.value?(r(),s("div",F,[(r(!0),s(_,null,b(K.value,(a=>(r(),s("div",{key:a._id,class:"album-item"},[n(j,{hoverable:"",onClick:e=>p(E).push(`/user/${H.value}/album/${a._id}`)},{cover:t((()=>{var e,l,u;return[a.coverImage?(r(),v(w,{key:0,src:(null==(u=null==(l=null==(e=p(G))?void 0:e.config)?void 0:l.site)?void 0:u.url)+a.coverImage.thumb,preview:!1},null,8,["src"])):(r(),s("div",P,"无封面"))]})),default:t((()=>[n(z,{title:a.name},null,8,["title"])])),_:2},1032,["onClick"])])))),128))])):(r(),v(u,{key:0,description:"暂无公开相册"}))])),_:1},8,["spinning"]),Q.value>O.value?(r(),s("div",q,[n(x,{current:N.value,"onUpdate:current":e[0]||(e[0]=a=>N.value=a),total:Q.value,"page-size":O.value,onChange:S},null,8,["current","total","page-size"])])):i("",!0)]})),_:1})):i("",!0)])}}},[["__scopeId","data-v-6d5ae094"]]);export{B as default};
